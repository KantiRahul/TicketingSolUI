sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/Popover","sap/m/MessageBox","sap/m/Button","sap/m/Bar","sap/m/VBox","sap/m/Label","sap/ui/model/json/JSONModel"],function(e,t,o,r,s,n,i,c){"use strict";return e.extend("com.wipro.ticketing.controller.TechnicianResolution",{onInit:function(){var e=this;if(!this.getView().getModel("view")){this.getView().setModel(new c,"view")}var t=sap.ui.core.UIComponent.getRouterFor(this);t.getRoute("RouteTresolution").attachPatternMatched(function(t){e.getView().getModel("odatamodel").read("/servicerequest",{success:function(t){e.getView().getModel("view").setProperty("/results",t.results);console.log("inside results localmodel ",e.getView().getModel("view").getProperty("/results"))}})})},logout:function(){console.log("preswsed");var e=sap.ui.core.UIComponent.getRouterFor(this);e.navTo("RouteLogin")},onBeforeRendering:function(){let e=this.getView().getModel("localmodel").getProperty("/technicianResolution")},ResolutionNav:function(){console.log("preswsed");var e=sap.ui.core.UIComponent.getRouterFor(this);e.navTo("RouteCresolution")},getServiceRequestObject:function(){var e=this;var t=this.getView().getModel("odatamodel");e.getView().getModel("odatamodel").read("/customer",{success:function(t){e.getView().getModel("view").setProperty("/results",t.results);console.log("inside results localmodel ",this.getView().getModel("view").getProperty("/results"))}})},handlePress:function(e){var t=new Date;var r=t.toISOString().slice(0,19).replace("T"," ");var s=this.getView().getModel("localmodel").getProperty("/techuserrname");var n=this.getView().getModel("localmodel").getProperty("/techuserId");console.log("Tech name is ",s);console.log("Tech id is ",n);var i=e.getSource().getBindingContext("view").getObject();var c=this;var a=new sap.m.Popover({title:"Issue Details",contentWidth:"300px",content:new sap.m.VBox({items:[new sap.m.Label({text:"Service ID: "+i.serReqID}),new sap.m.Label({text:"Customer ID: "+i.customerID}),new sap.m.Label({text:"Issue: "+i.issue}),new sap.m.Label({text:"Area of Concern: "+i.areaOfConcern}),new sap.m.Label({text:"Priority: "+(i.priority===0?"Low":"High")}),new sap.m.Label({text:"Expiration Date: "+i.expectedDate}),new sap.m.Label({text:"Status: "+i.status}),new sap.m.Label({text:"timeStamp: "+i.timeStamp})]}),footer:new sap.m.Bar({contentMiddle:[new sap.m.Button({text:"Work in Progress",press:function(){var t=e.getSource().getBindingContext("view");if(!t){console.error("Binding context is undefined.");return}var s=t.getPath();if(!s){console.error("Path to the selected item is undefined.");return}var n=t.getModel();n.setProperty(s+"/status","Work in Progress");var u=c.getView().getModel("odatamodel");var l=i.serReqID;u.update("/servicerequest('"+l+"')",{status:"Work in Progress"},{success:function(){console.log("Service request status updated to 'Work in Progress' in OData entity.")},error:function(e){console.error("Error updating service request status in OData entity:",e)}});u.read("/resolution('"+l+"')",{success:function(e){var t=e;t.resolTimeStamp=r;u.update("/resolution('"+l+"')",t,{success:function(e){console.log(e);o.success("Ticket updated as Work in progress")},error:function(e){o.error("Error occurred while updating record")}})},error:function(e){var t={serReqID:l,customerID:i.customerID,technicianID:"TEC2023",technicianName:"kanti",resolTimeStamp:r,res_serReqID:"12"};u.create("/resolution",t,{success:function(e){console.log(e);o.success("Ticket Resolved")},error:function(e){o.error("Error occurred while creating new record")}})}});a.close()}}),new sap.m.Button({text:"Resolved",press:function(){var t=e.getSource().getBindingContext("view");if(!t){console.error("Binding context is undefined.");return}var s=t.getPath();if(!s){console.error("Path to the selected item is undefined.");return}var n=t.getModel();n.setProperty(s+"/status","Resolved");var u=c.getView().getModel("odatamodel");var l=i.serReqID;u.update("/servicerequest('"+l+"')",{status:"Resolved"},{success:function(){console.log("Service request status updated to 'Resolved' in OData entity.")},error:function(e){console.error("Error updating service request status in OData entity:",e)}});var d={serReqID:l,customerID:i.customerID,technicianID:"TEC2023",technicianName:"kanti",resolTimeStamp:r,res_serReqID:"13"};u.read("/resolution('"+l+"')",{success:function(e){var t=e;t.resolTimeStamp=r;u.update("/resolution('"+l+"')",t,{success:function(e){console.log(e);o.success("Record updated successfully")},error:function(e){o.error("Error occurred while updating record")}})},error:function(e){var t={serReqID:l,customerID:i.customerID,technicianID:"TEC2023",technicianName:"kanti",resolTimeStamp:r,res_serReqID:"12"};u.create("/resolution",t,{success:function(e){console.log(e);o.success("New record created successfully")},error:function(e){o.error("Error occurred while creating new record")}})}});a.close()}}),new sap.m.Button({text:"Close",press:function(){a.close()}})]})});a.openBy(e.getSource())}})});
//# sourceMappingURL=TechnicianResolution.controller.js.map